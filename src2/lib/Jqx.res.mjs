// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Jq from "./Jq.res.mjs";
import * as Web from "./Web.res.mjs";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

function toJqArray(element) {
  if (element.TAG === "One") {
    return [element._0.element];
  } else {
    return Belt_Array.map(element._0, (function (param) {
                  return param.element;
                }));
  }
}

function array(elements) {
  return {
          TAG: "Many",
          _0: Belt_Array.flatMap(elements, (function (element) {
                  if (element.TAG === "One") {
                    return [element._0];
                  } else {
                    return element._0;
                  }
                }))
        };
}

function atom(element) {
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: (function () {
                
              })
          }
        };
}

function string(text) {
  var element = Jq.string(text);
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: (function () {
                
              })
          }
        };
}

function $$int(number) {
  return string(String(number));
}

function $$float(number) {
  return string(String(number));
}

function $$null() {
  var element = Jq.Dom.$$null();
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: (function () {
                
              })
          }
        };
}

function space() {
  var element = Jq.Dom.space();
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: (function () {
                
              })
          }
        };
}

function newline() {
  var element = Jq.Dom.newline();
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: (function () {
                
              })
          }
        };
}

function text(strings) {
  return array(Belt_Array.map(strings, string));
}

function ref(ref$1, element) {
  if (element.TAG === "One") {
    var element$1 = Jq.ref(ref$1, element._0.element);
    return {
            TAG: "One",
            _0: {
              element: element$1,
              dispose: (function () {
                  
                })
            }
          };
  }
  var match = element._0;
  if (match.length !== 1) {
    return $$null();
  }
  var match$1 = match[0];
  var element$2 = Jq.ref(ref$1, match$1.element);
  return {
          TAG: "One",
          _0: {
            element: element$2,
            dispose: (function () {
                
              })
          }
        };
}

function dispose(element) {
  if (element.TAG === "One") {
    return element._0.dispose();
  } else {
    return Belt_Array.forEach(element._0, (function (param) {
                  param.dispose();
                }));
  }
}

function make(tag, props) {
  var element = Jq.make(tag);
  var children = Belt_Option.mapWithDefault(props.children, [], toJqArray);
  Jq.append(element, children);
  Belt_Option.map(props.bind, (function (ref) {
          ref.contents = element;
        }));
  Belt_Option.map(props.class, (function ($$class) {
          Jq.addClass(element, $$class);
        }));
  Belt_Option.map(props.classes, (function (classes) {
          Jq.toggleClasses(element, classes);
        }));
  Belt_Option.map(props.dependencies, (function (dependencies) {
          Belt_Array.forEach(dependencies, (function (dependency) {
                  dependency();
                }));
        }));
  Belt_Option.map(props.attributes, (function (attributes) {
          Belt_Array.forEach(attributes, (function (param) {
                  Jq.setAttribute(element, param[0], param[1]);
                }));
        }));
  var onClickOnceHandler = Belt_Option.map(props.onClickOnce, (function (onClick) {
          return Jq.onClick(element, onClick, {
                      once: true
                    });
        }));
  var dispose$1 = function () {
    Belt_Option.map(props.children, dispose);
    Belt_Option.map(onClickOnceHandler, (function (handler) {
            Web.$$Event.removeClickListener(element, handler);
          }));
    Jq.remove(element);
  };
  return {
          TAG: "One",
          _0: {
            element: element,
            dispose: dispose$1
          }
        };
}

export {
  toJqArray ,
  array ,
  atom ,
  string ,
  $$int ,
  $$float ,
  $$null ,
  space ,
  newline ,
  text ,
  ref ,
  dispose ,
  make ,
}
/* Jq Not a pure module */
